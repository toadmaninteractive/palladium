(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{CBHK:function(t,e,i){"use strict";i.r(e);var n=i("ofXK"),a=i("tyNb"),s=i("NFeN"),o=i("Qu3c"),r=i("bFKe"),c=i("jRrs"),l=i("PCNd"),h=i("0Y/I"),d=i("j1ZV"),p=i("XNiG"),g=i("2Vo4"),b=i("1G5W"),u=i("vkgz"),m=i("ph7v"),y=i("xWQf"),f=i("aMtd"),x=i("fXoL"),w=i("itXk"),v=i("LRne"),k=i("pLZG"),C=i("bOdf"),P=i("Ehhc"),S=i("W4hA"),M=(i("kcOf"),i("Y40W"),i("vEia"));function O(t,e){if(1&t&&x.Tb(0,8),2&t){x.jc(2);const t=x.yc(3);x.pc("ngTemplateOutlet",t)}}function D(t,e){if(1&t&&(x.Xb(0,"div",4),x.Xb(1,"div",5),x.Nc(2),x.kc(3,"mNumeric"),x.Wb(),x.Xb(4,"div",6),x.Nc(5),x.Wb(),x.Lc(6,O,1,1,"ng-container",7),x.Wb()),2&t){const t=x.jc();x.Db(2),x.Oc(x.lc(3,3,t.value)),x.Db(3),x.Oc(t.unit),x.Db(1),x.pc("ngIf",t.showPrevValue)}}function _(t,e){if(1&t&&(x.Xb(0,"div",13),x.Sb(1,"div",14),x.Xb(2,"span"),x.Nc(3),x.Wb(),x.Wb()),2&t){const t=x.jc(4);x.Db(3),x.Pc("",t.changeInPercentage,"%")}}function T(t,e){if(1&t&&(x.Vb(0),x.Lc(1,_,4,1,"div",11),x.Xb(2,"div",12),x.Nc(3),x.Wb(),x.Ub()),2&t){const t=x.jc(3);x.Db(1),x.pc("ngIf",!!t.previous),x.Db(2),x.Pc("vs ",t.previous,"")}}function A(t,e){if(1&t&&(x.Xb(0,"div",16),x.Sb(1,"div",17),x.Xb(2,"span"),x.Nc(3),x.Wb(),x.Wb()),2&t){const t=x.jc(4);x.Db(3),x.Pc("",t.getPercentageAsAbsoluteNumber(t.changeInPercentage),"%")}}function L(t,e){if(1&t&&(x.Vb(0),x.Lc(1,A,4,1,"div",15),x.Xb(2,"div",12),x.Nc(3),x.Wb(),x.Ub()),2&t){const t=x.jc(3);x.Db(1),x.pc("ngIf",!!t.previous),x.Db(2),x.Pc("vs ",t.previous,"")}}function I(t,e){if(1&t&&(x.Vb(0),x.Xb(1,"div",18),x.Sb(2,"hr",19),x.Wb(),x.Xb(3,"div",12),x.Nc(4),x.Wb(),x.Ub()),2&t){const t=x.jc(3);x.Db(4),x.Pc("vs ",t.previous,"")}}function $(t,e){if(1&t&&(x.Vb(0),x.Xb(1,"div",10),x.Lc(2,T,4,2,"ng-container",9),x.Lc(3,L,4,2,"ng-container",9),x.Lc(4,I,5,1,"ng-container",9),x.Wb(),x.Ub()),2&t){const t=x.jc(2);x.Db(2),x.pc("ngIf",t.changeInPercentage>0),x.Db(1),x.pc("ngIf",t.changeInPercentage<0),x.Db(1),x.pc("ngIf",0===t.changeInPercentage)}}function j(t,e){if(1&t&&x.Lc(0,$,5,3,"ng-container",9),2&t){const t=x.jc();x.pc("ngIf",null!==t.changeInPercentage||void 0)}}function V(t,e){1&t&&(x.Xb(0,"div",20),x.Sb(1,"div",21),x.Sb(2,"div",22),x.Sb(3,"div",23),x.Wb())}let W=(()=>{class t{set _value(t){this.value=t.result.result[0].data[0].value,this.changeInPercentage=Math.round((this.value-this.previous)/this.previous*100)}set _previous(t){this.previous=t.result.result[0].data[0].value,this.changeInPercentage=Math.round((this.value-this.previous)/this.previous*100)}ngOnInit(){this.showPrevValue=this.determineShowPrevVals()}getPercentageAsAbsoluteNumber(t){return Math.abs(t)}determineShowPrevVals(){const t=[f.h.Month,f.h.Date,f.h.DateRange,f.h.TimePartition,f.h.Select];return this.params.some(e=>t.some(t=>t===e.type))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=x.Lb({type:t,selectors:[["m-kpi-widget"]],inputs:{_value:["value","_value"],_previous:["previous","_previous"],unit:"unit",params:"params"},decls:6,vars:2,consts:[[1,"kpi-container"],["class","kpi-value-container",4,"ngIf","ngIfElse"],["changeFromPrev",""],["loader",""],[1,"kpi-value-container"],[1,"kpi-value"],[1,"kpi-value-info-container"],[3,"ngTemplateOutlet",4,"ngIf"],[3,"ngTemplateOutlet"],[4,"ngIf"],[1,"rel-unit-container"],["class","caret-value caret-value-positive",4,"ngIf"],[1,"prev-value"],[1,"caret-value","caret-value-positive"],[1,"arrow-up"],["class","caret-value caret-value-negative",4,"ngIf"],[1,"caret-value","caret-value-negative"],[1,"arrow-down"],[1,"caret-value","caret-value-zero"],[2,"margin","0 0 5px 0"],[1,"loading-container"],[1,"loading-dot","loading-dot-1"],[1,"loading-dot","loading-dot-2"],[1,"loading-dot","loading-dot-3"]],template:function(t,e){if(1&t&&(x.Xb(0,"div",0),x.Lc(1,D,7,5,"div",1),x.Wb(),x.Lc(2,j,1,1,"ng-template",null,2,x.Mc),x.Lc(4,V,4,0,"ng-template",null,3,x.Mc)),2&t){const t=x.yc(5);x.Db(1),x.pc("ngIf",null!==e.value||void 0)("ngIfElse",t)}},directives:[n.m,n.r],pipes:[M.a],styles:[".kpi-container[_ngcontent-%COMP%]{font-style:normal;color:#000;align-content:center}.kpi-container[_ngcontent-%COMP%], .kpi-container[_ngcontent-%COMP%]   .kpi-value-container[_ngcontent-%COMP%]{height:100%;width:100%;display:-webkit-box;display:flex}.kpi-container[_ngcontent-%COMP%]   .kpi-value-container[_ngcontent-%COMP%]{-webkit-box-align:end;align-items:flex-end}.kpi-container[_ngcontent-%COMP%]   .kpi-value-container[_ngcontent-%COMP%]   .kpi-value[_ngcontent-%COMP%]{justify-self:flex-start;font-size:33px;font-weight:700;color:#6bcaff;line-height:90%}.kpi-container[_ngcontent-%COMP%]   .kpi-value-container[_ngcontent-%COMP%]   .kpi-value-info-container[_ngcontent-%COMP%]{margin-left:4px;color:#c4c4c4;font-weight:500}.rel-unit-container[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;margin-left:8px;margin-bottom:2px;align-self:flex-end;-webkit-box-pack:start;justify-content:flex-start;align-content:center;font-size:11px}.rel-unit-container[_ngcontent-%COMP%]   .caret-value[_ngcontent-%COMP%]{line-height:10px;margin-bottom:3px}.rel-unit-container[_ngcontent-%COMP%]   .caret-value[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:700}.rel-unit-container[_ngcontent-%COMP%]   .caret-value[_ngcontent-%COMP%]   .arrow-down[_ngcontent-%COMP%], .rel-unit-container[_ngcontent-%COMP%]   .caret-value[_ngcontent-%COMP%]   .arrow-up[_ngcontent-%COMP%]{display:inline-block;width:0;height:0;margin-right:3px;border-left:4px solid transparent;border-right:4px solid transparent;border-bottom:8px solid #34bfa3}.rel-unit-container[_ngcontent-%COMP%]   .caret-value[_ngcontent-%COMP%]   .arrow-down[_ngcontent-%COMP%]{border-bottom:none;border-top:8px solid #ff7d85}.rel-unit-container[_ngcontent-%COMP%]   .caret-value-negative[_ngcontent-%COMP%]{color:#ff7d85}.rel-unit-container[_ngcontent-%COMP%]   .caret-value-positive[_ngcontent-%COMP%]{color:#34bfa3}.rel-unit-container[_ngcontent-%COMP%]   .caret-value-zero[_ngcontent-%COMP%]{color:#c4c4c4}.rel-unit-container[_ngcontent-%COMP%]   .prev-value[_ngcontent-%COMP%]{line-height:10px;color:#c4c4c4;font-weight:700}.loading-container[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;height:100%;width:100%;padding-top:10px;padding-bottom:10px}.loading-container[_ngcontent-%COMP%]   .loading-dot[_ngcontent-%COMP%]{height:17px;width:17px;border-radius:50%;margin-right:3px;background-color:#d7d7d7}.loading-container[_ngcontent-%COMP%]   .loading-dot-1[_ngcontent-%COMP%]{-webkit-animation:loadingAnimation 2s ease .1s infinite;animation:loadingAnimation 2s ease .1s infinite}.loading-container[_ngcontent-%COMP%]   .loading-dot-2[_ngcontent-%COMP%]{-webkit-animation:loadingAnimation 2s ease .2s infinite;animation:loadingAnimation 2s ease .2s infinite}.loading-container[_ngcontent-%COMP%]   .loading-dot-3[_ngcontent-%COMP%]{-webkit-animation:loadingAnimation 2s ease .3s infinite;animation:loadingAnimation 2s ease .3s infinite}@-webkit-keyframes loadingAnimation{0%{opacity:1}20%{opacity:0}40%{opacity:0}60%{opacity:1}to{opacity:1}}@keyframes loadingAnimation{0%{opacity:1}20%{opacity:0}40%{opacity:0}60%{opacity:1}to{opacity:1}}"]}),t})();var E=i("VphZ"),B=i("Kj3r"),X=i("nuVB"),R=i("DUuJ"),q=i("kkSj"),z=i("yrPX"),N=i("ITC6");const U=["chartContainer"],K=["plotContainer"],Y=["barsContainer"],F=["mouseMoveRect"],H=["linesContainer"],J=["axisBottom"],G=["axisTop"],Q=["axisLeft"],Z=["axisRight"],tt=["xGrid"],et=["yGrid"],it=["axisContextBottom"],nt=["axisContextLeft"],at=["timecontext"],st=["timecontextLine"],ot=["timecontextBrush"],rt=["zoomContainer"],ct=["measureCanvas"],lt=["tooltipContainer"],ht=["tooltipContainerBar"];function dt(t,e){if(1&t){const t=x.Yb();x.Xb(0,"div",46),x.fc("click",(function(){x.Cc(t);const i=e.$implicit;return x.jc(3).toggleSeries(i.key)})),x.Sb(1,"span",47),x.Xb(2,"span",48),x.Nc(3),x.Wb(),x.Wb()}if(2&t){const t=e.$implicit,i=x.jc(3);x.Db(1),x.Kc("background-color",i.legendSeriesMap.has(t.key)?i.getColorByKey(t.key):"#ccc"),x.Db(1),x.Kc("opacity",i.legendSeriesMap.has(t.key)?1:.3),x.Db(1),x.Pc(" ",i.getSeriesOptions(t.key).name," ")}}function pt(t,e){if(1&t&&(x.Vb(0),x.Xb(1,"div",43),x.Xb(2,"div",44),x.Lc(3,dt,4,5,"div",45),x.Wb(),x.Wb(),x.Ub()),2&t){const t=x.jc(2);x.Db(3),x.pc("ngForOf",t.drawingSeries)}}function gt(t,e){if(1&t&&(x.Vb(0),x.Lc(1,pt,4,1,"ng-container",1),x.kc(2,"async"),x.Ub()),2&t){const t=x.jc();x.Db(1),x.pc("ngIf",x.lc(2,1,t.options$).showLegend)}}function bt(t,e){if(1&t&&(x.ic(),x.Xb(0,"g",49),x.Sb(1,"path"),x.kc(2,"async"),x.Wb()),2&t){const t=x.jc();x.Db(1),x.Eb("d",t.drawVerticalLine(x.lc(2,1,t.tooltipXCoordinate$)))}}function ut(t,e){if(1&t&&(x.ic(),x.Xb(0,"text"),x.Nc(1),x.kc(2,"async"),x.Wb()),2&t){const t=x.jc();x.Db(1),x.Oc(x.lc(2,1,t.options$).xAxisTitle)}}function mt(t,e){1&t&&(x.ic(),x.Sb(0,"rect")),2&t&&x.Eb("x",-50)("y",-6)("fill","rgba(0, 0, 0, 0.06)")("width",110)("height",6)("stroke-linecap","round")("rx",5)("ry",5)}function yt(t,e){if(1&t&&(x.ic(),x.Xb(0,"g",50),x.Xb(1,"text"),x.Nc(2),x.kc(3,"async"),x.Wb(),x.Wb()),2&t){const t=x.jc();x.Eb("transform","rotate(-90)  translate("+(0-t.leftAxisTitleTranslate)+","+(0-t.maxLabelYPrimaryWidth)+")"),x.Db(2),x.Oc(x.lc(3,2,t.options$).yAxisTitle)}}function ft(t,e){if(1&t&&(x.ic(),x.Xb(0,"g",51),x.Xb(1,"text"),x.Nc(2),x.kc(3,"async"),x.Wb(),x.Wb()),2&t){const t=x.jc();x.Eb("transform","rotate(90) translate("+t.rightAxisTitleTranslate+","+(0-(t.plotProps.width+t.maxLabelYSecondaryWidth))+")"),x.Db(2),x.Oc(x.lc(3,2,t.options$).secondaryYAxisTitle)}}function xt(t,e){if(1&t&&(x.ic(),x.hc(),x.Xb(0,"div",52,53),x.kc(2,"async"),x.Xb(3,"span",54),x.Nc(4),x.Wb(),x.Sb(5,"ul",55),x.kc(6,"safe"),x.Wb()),2&t){const t=x.jc();x.Kc("opacity",x.lc(2,8,t.tooltipXCoordinate$)?".8":"0")("top",t.tooltipPosition.top,"px")("left",t.tooltipPosition.left,"px"),x.Db(4),x.Oc(t.tooltipHeader),x.Db(1),x.pc("innerHTML",x.mc(6,10,t.tooltipContent,"html"),x.Dc)}}function wt(t,e){if(1&t&&(x.ic(),x.hc(),x.Xb(0,"div",56,57),x.Xb(2,"span",54),x.Nc(3),x.Wb(),x.Sb(4,"ul",55),x.kc(5,"safe"),x.Wb()),2&t){const t=x.jc();x.Kc("opacity",t.selectedSeriesKey?".8":"0")("top",t.tooltipPosition.top,"px")("left",t.tooltipPosition.left,"px"),x.Db(3),x.Oc(t.tooltipHeader),x.Db(1),x.pc("innerHTML",x.mc(5,8,t.tooltipContent,"html"),x.Dc)}}function vt(t,e){1&t&&x.Sb(0,"m-loading-indicator",58),2&t&&x.pc("isInline",!0)}let kt=(()=>{class t extends X.a{constructor(t,e,i){super(),this.cdr=t,this.chartBoxExpansionService=e,this.menuAsideService=i,this.options$=new g.a(null),this.uniqId$=new g.a(null),this.series$=new g.a([]),this.destroy$=new p.a,this.tooltipXCoordinate$=new g.a(null),this.maxLabelYPrimaryWidth=0,this.maxLabelYSecondaryWidth=0,this.fontSize=14,this.marginBetweenAxisLabelsAndTitle=15,this.rotationDegree=-20,this.tooltipPosition={left:0,top:0},this.tooltipContent="",this.tooltipHeader="",this.paddingXTypeLine=0,this.resize=new p.a,this.legendSeriesMap=new Map,this.drawingSeries=new Array,this.formattedBarSeries=[],this.selectedSeriesKey=!1,this.uniqueId=(new Date).valueOf(),Object(w.a)(this.options$.asObservable(),this.series$.pipe(Object(k.a)(t=>!!t))).pipe(Object(b.a)(this.destroy$),Object(B.a)(250)).subscribe(([t,e])=>{this.pristineOptions=t,this.drawingSeries=e.map(e=>{const i=e;return i.data.map(e=>{const i=e;return i.label=this.dateParse(e.label,t),i}),i}),this.drawingSeries.forEach(t=>this.legendSeriesMap.set(t.key,t)),this.existBarSeries=this.drawingSeries.filter(t=>this.getSeriesOptions(t.key).chartType===y.d.VerticalBar).length>0,this.existLineSeries=this.drawingSeries.filter(t=>this.getSeriesOptions(t.key).chartType!==y.d.VerticalBar).length>0,this.existBarSeries&&(this.formattedBarSeries=this.convertBarData(this.drawingSeries.filter(t=>this.getSeriesOptions(t.key).chartType===y.d.VerticalBar))),this.drawingSeries.length>0&&this.drawChart(this.drawingSeries,this.pristineOptions),setTimeout(()=>this.cdr.detectChanges())}),this.resize.pipe(Object(B.a)(400)).subscribe(()=>{const t=this.chartContainer.nativeElement.getBoundingClientRect().width-this.padding.left-this.padding.right,e=this.chartContainer.nativeElement.getBoundingClientRect().height-this.padding.top-this.padding.bottom;this.plotProps.width===t&&this.plotProps.height===e||(E.w(this.barsContainer.nativeElement).selectAll("g").remove(),this.drawChart(this.drawingSeries,this.pristineOptions),setTimeout(()=>this.cdr.detectChanges()))}),this.menuAsideService.menuToggled$.subscribe(()=>{this.drawChart(this.drawingSeries,this.pristineOptions),setTimeout(()=>this.cdr.detectChanges())})}set _options(t){this.options$.next(t)}set _seriesData(t){this.series$.next(t)}set _uniqId(t){this.uniqId=t||"0",this.uniqId$.next(t)}shiftPushed(){this.shiftState=!0}shiftReleased(){this.shiftState=!1}ngOnInit(){this.tooltipXCoordinate$.pipe(Object(k.a)(t=>null!==t),Object(b.a)(this.destroy$)).subscribe(t=>{this.tooltipContent=this.getTooltipContent(t)})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}ngAfterViewInit(){this.context=this.canvas.nativeElement.getContext("2d"),this.context.font=this.fontSize+"px Ubuntu"}drawChart(t,e){this.setUniqueAxisValues(t),this.maxLabelYPrimaryWidth=this.marginBetweenAxisLabelsAndTitle+this.getMaxWidth(this.yPrimaryValues,e.yAxisType),this.maxLabelYSecondaryWidth=this.marginBetweenAxisLabelsAndTitle+this.getMaxWidth(this.ySecondaryValues,e.yAxisType),this.padding.top=5,this.padding.left=0,this.padding.left+=this.maxLabelYPrimaryWidth!==-1/0?this.maxLabelYPrimaryWidth:10,this.padding.left+=e.yAxisTitle?this.fontSize:0,this.padding.right=0,this.padding.right+=this.maxLabelYSecondaryWidth!==-1/0?this.maxLabelYSecondaryWidth:10,this.padding.right+=e.secondaryYAxisTitle?this.fontSize:0,this.padding.bottom=30;const i=this.chartContainer.nativeElement.getBoundingClientRect().width-this.padding.left-this.padding.right,n=this.chartContainer.nativeElement.getBoundingClientRect().height-this.padding.top-this.padding.bottom-10;this.plotProps.width=i!==1/0?i:0,this.plotProps.height=n!==1/0?n:0,this.leftAxisTitleTranslate=(this.plotProps.height+this.context.measureText(e.yAxisTitle).width)/2,this.rightAxisTitleTranslate=(this.plotProps.height-this.context.measureText(e.secondaryYAxisTitle).width)/2,this.bottomAxisTranslate=(this.plotProps.width-this.context.measureText(e.xAxisTitle).width)/2,this.createScales(e),this.createAxis(e),this.appendAxis(),this.addGridLines(e),this.addMouseMoveRect(),this.existBarSeries&&(this.createSubgroupScale(),this.drawBars()),this.commonDraw(!0,t),e.showTimeline&&(this.addZoom(),this.addTimelineAxis(this.axisTimelineBottom,e),E.w(this.axisTimelineBottom.nativeElement).selectAll("text").attr("transform",this.needRotateAxisLabel()?"rotate("+this.rotationDegree+")":null).style("text-anchor",this.needRotateAxisLabel()?"end":"middle"),this.drawTimeline(t))}brushed(){if(E.n&&E.n.sourceEvent&&"zoom"===E.n.sourceEvent.type)return;const t=E.n&&E.n.selection||this.xTimelineScale.range();this.xPrimaryScale.domain(t.map(this.xTimelineScale.invert,this.xTimelineScale)),this.createAxis(this.pristineOptions),E.w(this.axisBottom.nativeElement).call(this.xPrimaryAxis).selectAll("text").attr("transform",this.needRotateAxisLabel()?"rotate("+this.rotationDegree+")":null).style("text-anchor",this.needRotateAxisLabel()?"end":"middle"),E.w(this.timeContextBrush.nativeElement).selectAll(".handle--custom").attr("transform",e=>"w"===e?"translate("+t[0]+", 0)":"translate("+t[1]+", 0)"),E.w(this.timeContextBrush.nativeElement).selectAll(".handle--mini").attr("transform",e=>"w"===e?"translate("+(t[0]-2)+", 12)":"translate("+(t[1]-2)+", 12)"),this.commonDraw(!1,this.drawingSeries.filter(t=>this.legendSeriesMap.has(t.key))),E.w(this.zoomContainer.nativeElement).call(this.zoom.transform,E.I.scale(this.plotProps.width/(t[1]-t[0])).translate(-t[0],0))}zoomed(){if(this.shiftState){if(E.n.sourceEvent&&"brush"===E.n.sourceEvent.type)return;const t=E.n.transform;this.xPrimaryScale.domain(t.rescaleX(this.xTimelineScale).domain()),this.commonDraw(!1,this.drawingSeries.filter(t=>this.legendSeriesMap.has(t.key))),this.createAxis(this.pristineOptions),E.w(this.axisBottom.nativeElement).call(this.xPrimaryAxis).selectAll("text").attr("transform",this.needRotateAxisLabel()?"rotate("+this.rotationDegree+")":null).style("text-anchor",this.needRotateAxisLabel()?"end":"middle"),E.w(this.timeContextBrush.nativeElement).call(this.brush.move,this.xPrimaryScale.range().map(t.invertX,t)).selectAll("rect").attr("transform","translate("+this.padding.left+",0)")}}addMouseMoveRect(){E.w(this.zoomContainer.nativeElement).style("fill","none").style("pointer-events","all").attr("width",this.plotProps.width).attr("height",this.plotProps.height).on("mousemove",()=>this.showTooltipLine()).on("mouseleave",()=>this.hideTooltipLine())}appendAxis(){this.xPrimaryAxis&&E.w(this.axisBottom.nativeElement).transition().duration(800).call(this.xPrimaryAxis).selectAll("text").attr("transform",this.needRotateAxisLabel()?"rotate("+this.rotationDegree+")":null).style("text-anchor",this.needRotateAxisLabel()?"end":"middle"),this.xSecondaryAxis&&E.w(this.axisTop.nativeElement).transition().duration(800).call(this.xSecondaryAxis),this.yPrimaryAxis&&E.w(this.axisLeft.nativeElement).transition().duration(800).call(this.yPrimaryAxis),this.ySecondaryAxis&&E.w(this.axisRight.nativeElement).transition().duration(800).call(this.ySecondaryAxis)}createSubgroupScale(){const t=this.drawingSeries.filter(t=>this.getSeriesOptions(t.key).chartType!==y.d.VerticalBar).map(t=>t.key);this.xSubgroupScale=t.length>1?E.t().domain(t).range([0,this.xPrimaryScale.bandwidth()]).paddingInner(.25).paddingOuter(.3):E.t().domain(t).range([0,this.xPrimaryScale.bandwidth()]).paddingOuter(.25)}commonDraw(t,e){E.w(this.linesContainer.nativeElement).selectAll(".dots").remove(),E.w(this.linesContainer.nativeElement).selectAll(".dots-bg").remove(),E.w(this.linesContainer.nativeElement).selectAll("path").remove(),Object.keys(y.d).filter(t=>/^[0-9]+$/.test(t)).map(t=>+t).filter(t=>t!==y.d.VerticalBar).forEach(i=>{let n,a,s;const o=e.filter(t=>this.getSeriesOptions(t.key).chartType===i);if(t&&o.length>0)switch(n=E.w(this.linesContainer.nativeElement).append("g").attr("class",y.d[i]),i){case y.d.Line:case y.d.Spline:a=n.selectAll(".spline-line").data(o).enter().append("path").attr("class",t=>t.key+" spline-line").attr("d",t=>this.drawLine(t.data,this.getSeriesOptions(t.key).yAxis,!0,i===y.d.Spline)).attr("fill","none").attr("stroke",t=>this.getColorByKey(t.key)).attr("stroke-width",2).style("opacity",1).on("mousemove",()=>this.showTooltipLine()).on("mouseleave",()=>this.hideTooltipLine()),a.each((function(t){t.totalLength=this.getTotalLength()})).attr("stroke-dasharray",t=>t.totalLength+" "+t.totalLength).attr("stroke-dashoffset",t=>t.totalLength).transition().duration(2e3).attr("stroke-dashoffset",0);break;case y.d.Area:case y.d.AreaSpline:s=n.selectAll(".areaFill").data(o).enter().append("path").attr("class",t=>t.key+" areaFill").attr("fill",t=>this.getColorByKey(t.key)).attr("stroke",t=>this.getColorByKey(t.key)).attr("stroke-width",4).style("opacity",.2).attr("d",t=>this.drawArea(t.data,this.getSeriesOptions(t.key).yAxis,!1,i===y.d.AreaSpline)).on("mousemove",()=>this.showTooltipLine()).on("mouseleave",()=>this.hideTooltipLine()).transition().duration(2e3).attr("d",t=>this.drawArea(t.data,this.getSeriesOptions(t.key).yAxis,!0,i===y.d.AreaSpline)),a=n.selectAll(".areaContour").data(o).enter().append("path").attr("class",t=>t.key+" areaContour").attr("fill","none").attr("stroke",t=>this.getColorByKey(t.key)).attr("stroke-width",2).style("opacity",1).attr("d",t=>this.drawLine(t.data,this.getSeriesOptions(t.key).yAxis,!0,i===y.d.AreaSpline)).transition().duration(2e3).attr("d",t=>this.drawLine(t.data,this.getSeriesOptions(t.key).yAxis,!0,i===y.d.AreaSpline))}else if(o.length>0)switch(n=E.w(this.linesContainer.nativeElement).select("."+y.d[i]),i){case y.d.Line:case y.d.Spline:a=n.selectAll(".spline-line").data(o).enter().append("path").attr("d",t=>this.drawLine(t.data,this.getSeriesOptions(t.key).yAxis,!0,i===y.d.Spline)).attr("class",t=>t.key+" spline-line").attr("fill","none").attr("stroke",t=>this.getColorByKey(t.key)).attr("stroke-width",2).attr("stroke-dashoffset",0).attr("stroke-dasharray",t=>this.getStrokeDasharray(t.key)).attr("stroke-dashoffset",t=>this.getStrokeDashoffset(t.key)).on("mousemove",()=>this.showTooltipLine()).on("mouseleave",()=>this.hideTooltipLine());break;case y.d.Area:case y.d.AreaSpline:s=n.selectAll(".areaFill").data(o).enter().append("path").attr("class",t=>t.key+" areaFill").attr("fill",t=>this.getColorByKey(t.key)).attr("stroke",t=>this.getColorByKey(t.key)).attr("stroke-width",4).style("opacity",.2).attr("d",t=>this.drawArea(t.data,this.getSeriesOptions(t.key).yAxis,!0,i===y.d.AreaSpline)).on("mousemove",()=>this.showTooltipLine()).on("mouseleave",()=>this.hideTooltipLine()),a=n.selectAll(".areaContour").data(o).enter().append("path").attr("class",t=>t.key+" areaContour").attr("fill","none").attr("stroke",t=>this.getColorByKey(t.key)).attr("stroke-width",2).attr("stroke-dasharray",t=>this.getStrokeDasharray(t.key)).attr("stroke-dashoffset",t=>this.getStrokeDashoffset(t.key)).style("opacity",1).attr("d",t=>this.drawLine(t.data,this.getSeriesOptions(t.key).yAxis,!0,i===y.d.AreaSpline))}o.forEach(t=>{E.w(this.linesContainer.nativeElement).append("g").classed("dots-bg "+t.key,!0).selectAll("circle").data(t.data).enter().append("circle").classed("dot-line-background",!0).attr("fill",e=>this.getColorByKey(t.key)).attr("cx",t=>this.xPrimaryScale(t.label)).attr("cy",e=>this.getSeriesOptions(t.key).yAxis===y.a.Primary?this.yPrimaryScale(e.value):this.ySecondaryScale(e.value)).attr("r",8).attr("fill-opacity",0),E.w(this.linesContainer.nativeElement).append("g").classed("dots "+t.key,!0).selectAll("circle").data(t.data).enter().append("circle").classed("dot-line",!0).attr("fill",e=>this.getColorByKey(t.key)).attr("cx",t=>this.xPrimaryScale(t.label)).attr("cy",e=>this.getSeriesOptions(t.key).yAxis===y.a.Primary?this.yPrimaryScale(e.value):this.ySecondaryScale(e.value)).attr("r",2).attr("stroke","white").attr("stroke-width",.1)})})}drawTimeline(t){t&&(E.w(this.timeContextLine.nativeElement).selectAll("path").remove(),E.w(this.timeContextLine.nativeElement).selectAll("path").data(t).enter().append("path").attr("class",t=>t.key+" timeline").attr("d",(t,e)=>this.drawContextLine(t.data,e)).attr("fill","none").attr("stroke",t=>this.getColorByKey(t.key)).attr("stroke-width",2).style("opacity",1))}drawLine(t,e,i=!0,n=!1){if(!t)return;const a=this.xPrimaryScale,s=e===y.a.Primary?this.yPrimaryScale:this.ySecondaryScale;return E.p().curve(n?E.j:E.i).x(t=>a(t.label)).y(t=>s(i?t.value:0))(t)}drawContextLine(t,e){return E.p().x(t=>this.xTimelineScale(t.label)).y(t=>this.yTimelineScale(t.value))(t)}drawArea(t,e,i,n=!1){const a=this.xPrimaryScale,s=e===y.a.Primary?this.yPrimaryScale:this.ySecondaryScale;return E.a().curve(n?E.j:E.i).x(t=>a(t.label)).y(s(0)).y1(t=>s(i?t.value:0))(t)}drawBars(){const t=E.w(this.barsContainer.nativeElement).selectAll("g").data(this.formattedBarSeries,t=>t.label);t.exit().remove();const e=t.enter().append("g").merge(t).attr("transform",t=>"translate("+this.xPrimaryScale(t.label)+", 0)").merge(t).selectAll("rect").data(t=>t.values);e.exit().remove(),e.enter().append("rect").merge(e).attr("class",t=>t.key+" v-bars").attr("x",t=>this.xSubgroupScale(t.key)).attr("width",this.xSubgroupScale.bandwidth()).attr("fill",t=>this.getColorByKey(t.key)).attr("y",t=>this.plotProps.height).attr("height",this.yPrimaryScale(0)).on("mouseover",t=>this.showTooltipRect(t)).on("mouseleave",t=>this.hideTooltipRect()).transition().duration(800).ease(E.m).attr("y",t=>this.yPrimaryScale(t.value)===this.plotProps.height?this.plotProps.height-1:this.yPrimaryScale(t.value)).attr("height",t=>this.plotProps.height-this.yPrimaryScale(t.value)==0?1:this.plotProps.height-this.yPrimaryScale(t.value))}convertBarData(t){const e=[];return t.forEach(t=>t.data.forEach((i,n)=>{0===e.filter(t=>t.label===i.label).length&&e.push({label:i.label,values:[]}),e.filter(t=>t.label===i.label)[0].values.push({key:t.key,value:i.value})})),e}needRotateAxisLabel(){let t=this.xPrimaryValues;if(this.options$.getValue().xAxisType===y.b.Date){const e=this.xPrimaryValues.map(t=>new Date(+t)),i=Math.max.apply(null,e),n=Math.min.apply(null,e),a=Math.abs(i-n)/864e5;t=t.map(t=>a>365?new Date(+t).toLocaleDateString("ru-RU"):new Date(+t).toLocaleDateString("ru-RU").slice(0,-5))}this.options$.getValue().xAxisType===y.b.Text&&(this.paddingXTypeLine=this.xPrimaryScale.bandwidth()/2);const e=(this.chartContainer.nativeElement.getBoundingClientRect().width-this.padding.left-this.padding.right)/this.calculateTickCount(t),i=Math.max(...t.map(t=>this.context.measureText(t).width))+20;return i>e||!(!this.xPrimaryScale||this.options$.getValue().xAxisType!==y.b.Date)&&this.getMinimalTickDistance(this.xPrimaryScale)<i}showTooltipLine(){if(this.existLineSeries){const t=E.r(E.n.target)[0],e=this.drawingSeries.reduce((t,e)=>t.concat(e.data),[]).map(t=>t.label);let i=null,n=1/0;e.forEach(e=>{const a=Math.abs(t-this.xPrimaryScale(e));a<n&&(n=a,i=e)});const a=this.xPrimaryScale(i),s=this.tooltipRef.nativeElement.getBoundingClientRect(),o=this.getNearestSeriesKey(E.r(E.n.target)[1],i),r=this.drawingSeries.find(t=>t.key===o),c=r.data.find(t=>this.pristineOptions.xAxisType===y.b.Date?new Date(+t.label).getTime()===new Date(+i).getTime():t.label===i).value,l=this.getSeriesOptions(r.key).yAxis===y.a.Primary?this.yPrimaryScale(c):this.ySecondaryScale(c);this.tooltipPosition.left=a+this.padding.left-s.width/2+(this.pristineOptions.xAxisType===y.b.Text?this.xPrimaryScale.bandwidth()/2:0),this.tooltipPosition.top=l-s.height-10,this.cdr.detectChanges(),this.tooltipXCoordinate$.next(i),E.w(this.linesContainer.nativeElement).selectAll("path").filter((function(){this.classList.contains(r.key)?(this.setAttribute("style","opacity:1"),this.classList.contains("areaFill")&&this.setAttribute("style","opacity:0.5")):this.setAttribute("style","opacity:0.2")})),E.w(this.chartContainer.nativeElement).selectAll(".dots-bg").selectAll("circle").attr("fill-opacity",0),E.w(this.chartContainer.nativeElement).select(".dots-bg."+r.key).selectAll("circle").attr("fill-opacity",t=>t.label instanceof Date&&i instanceof Date?t.label.getTime()===i.getTime()?.25:0:t.label===i?.25:0),E.w(this.linesContainer.nativeElement).selectAll(".dots").filter((function(){this.classList.contains(r.key)?E.w(this).selectAll("circle").attr("opacity",1).attr("r",t=>t.label instanceof Date&&i instanceof Date?t.label.getTime()===i.getTime()?4:2:t.label===i?4:2):E.w(this).selectAll("circle").attr("opacity",.2).attr("r",2)}))}}showTooltipRect(t){if(this.existBarSeries){const e=E.n.target.getBoundingClientRect();this.selectedSeriesKey=!0;const i=this.drawingSeries.filter(e=>e.key===t.key)[0];this.tooltipContent="",this.getSeriesOptions(i.key).name?this.tooltipContent=this.getSeriesOptions(i.key).name+": <strong>"+this.formatValue(t.value)+"</strong>":this.tooltipContent+=this.formatValue(t.value)+"",this.cdr.detectChanges(),E.w(this.barsContainer.nativeElement).selectAll("rect").filter((function(){this.classList.contains(i.key)?this.setAttribute("style","opacity:1"):this.setAttribute("style","opacity:0.2")}));const n=this.tooltipRefBar.nativeElement.getBoundingClientRect();this.tooltipPosition.top=e.top-n.height-6,this.tooltipPosition.left=e.left+e.width/2-n.width/2,this.cdr.detectChanges()}}hideTooltipRect(){this.selectedSeriesKey=!1,E.w(this.barsContainer.nativeElement).selectAll("rect").filter((function(){this.classList.contains("v-bars")&&this.setAttribute("style","opacity:1")})),this.cdr.detectChanges()}hideTooltipLine(){this.tooltipXCoordinate$.next(null),E.w(this.linesContainer.nativeElement).selectAll("path").filter((function(t,e){this.classList.contains("areaContour")&&this.setAttribute("style","opacity:1"),this.classList.contains("areaFill")&&this.setAttribute("style","opacity:0.2"),this.classList.contains("spline-line")&&this.setAttribute("style","opacity:1")})),E.w(this.linesContainer.nativeElement).selectAll(".dots").filter((function(){E.w(this).selectAll("circle").attr("opacity",1).attr("r",2)}))}getNearestSeriesKey(t,e){const i=[];return this.drawingSeries.length?(this.drawingSeries.filter(t=>this.legendSeriesMap.has(t.key)).map(n=>n.data.filter(t=>this.pristineOptions.xAxisType===y.b.Date?new Date(+t.label).getTime()===new Date(+e).getTime():t.label===e).forEach(e=>i.push({key:n.key,value:Math.abs(t-(this.getSeriesOptions(n.key).yAxis===y.a.Primary?this.yPrimaryScale(e.value):this.ySecondaryScale(e.value)))}))),i.sort((t,e)=>t.value>e.value?1:-1)[0].key):null}getTooltipContent(t){if(!this.series$.getValue()||!t)return"";this.tooltipHeader=this.pristineOptions.xAxisType===y.b.Date?new Date(+t).toLocaleDateString("ru-RU"):t;let e="";return this.drawingSeries.forEach(i=>{const n=i.data.filter(e=>this.pristineOptions.xAxisType===y.b.Date?new Date(+e.label).getTime()===new Date(+t).getTime():e.label===t)[0].value;e+='<li><span style="margin: 0 3px; color:'+this.getColorByKey(i.key)+'">\u25cf</span>'+this.getSeriesOptions(i.key).name+": <b>"+(n<10?Math.round(10*n)/10:Math.round(n))+"</b></li>"}),e}toggleSeries(t){if(this.legendSeriesMap.has(t))this.legendSeriesMap.delete(t);else{const e=this.drawingSeries.find(e=>e.key===t);this.legendSeriesMap.set(e.key,e)}this.setUniqueAxisValues(this.drawingSeries.filter(t=>this.legendSeriesMap.has(t.key))),this.yPrimaryScale=this.yPrimaryScale?this.setYScale(this.plotProps.height,this.yPrimaryValues,this.options$.getValue().yAxisType):null,this.ySecondaryScale=this.ySecondaryScale?this.setYScale(this.plotProps.height,this.ySecondaryValues,this.options$.getValue().secondaryYAxisType):null,this.yPrimaryScale&&(this.yPrimaryAxis=E.d(this.yPrimaryScale)),this.ySecondaryScale&&(this.ySecondaryAxis=E.e(this.ySecondaryScale)),this.yPrimaryAxis&&E.w(this.axisLeft.nativeElement).transition().duration(800).call(this.yPrimaryAxis),this.ySecondaryAxis&&E.w(this.axisRight.nativeElement).transition().duration(800).call(this.ySecondaryAxis),this.existBarSeries=this.drawingSeries.filter(t=>this.getSeriesOptions(t.key).chartType===y.d.VerticalBar&&this.legendSeriesMap.has(t.key)).length>0,this.existBarSeries&&(this.formattedBarSeries=this.convertBarData(this.drawingSeries.filter(t=>this.getSeriesOptions(t.key).chartType===y.d.VerticalBar&&this.legendSeriesMap.has(t.key)))),this.existBarSeries?(this.createSubgroupScale(),this.drawBars()):this.clearBars(),this.commonDraw(!1,this.drawingSeries.filter(t=>this.getSeriesOptions(t.key).chartType!==y.d.VerticalBar&&this.legendSeriesMap.has(t.key)))}clearBars(){E.w(this.barsContainer.nativeElement).selectAll("g").remove()}getColorByKey(t){if(this.getSeriesOptions(t).color)return this.getSeriesOptions(t).color;const e=this.drawingSeries.findIndex(e=>e.key===t);return-1===e?"#000":this.colorPalette[e%this.colorPalette.length]}formatValue(t){return Math.round(100*t)/100}getMaxWidth(t,e){return e===y.b.Date&&(t=t.map(t=>new Date(t).toLocaleDateString("ru-RU"))),Math.max(...t.map(t=>isNaN(+t)?this.context.measureText(t).width:this.context.measureText(Math.round(10*+t)/10+"").width))+5+5}redraw(){this.resize.next()}}return t.\u0275fac=function(e){return new(e||t)(x.Rb(x.h),x.Rb(R.a),x.Rb(q.a))},t.\u0275cmp=x.Lb({type:t,selectors:[["m-d3-dashboard-plot"]],viewQuery:function(t,e){var i;1&t&&(x.Ic(U,!0),x.Ic(K,!0),x.Ic(Y,!0),x.Ic(F,!0),x.Ic(H,!0),x.Ic(J,!0),x.Ic(G,!0),x.Ic(Q,!0),x.Ic(Z,!0),x.Ic(tt,!0),x.Ic(et,!0),x.Ic(it,!0),x.Ic(nt,!0),x.Sc(at,!0),x.Sc(st,!0),x.Sc(ot,!0),x.Sc(rt,!0),x.Sc(ct,!0),x.Sc(lt,!0),x.Sc(ht,!0)),2&t&&(x.xc(i=x.gc())&&(e.chartContainer=i.first),x.xc(i=x.gc())&&(e.plotContainer=i.first),x.xc(i=x.gc())&&(e.barsContainer=i.first),x.xc(i=x.gc())&&(e.mouseMoveRect=i.first),x.xc(i=x.gc())&&(e.linesContainer=i.first),x.xc(i=x.gc())&&(e.axisBottom=i.first),x.xc(i=x.gc())&&(e.axisTop=i.first),x.xc(i=x.gc())&&(e.axisLeft=i.first),x.xc(i=x.gc())&&(e.axisRight=i.first),x.xc(i=x.gc())&&(e.xGrid=i.first),x.xc(i=x.gc())&&(e.yGrid=i.first),x.xc(i=x.gc())&&(e.axisTimelineBottom=i.first),x.xc(i=x.gc())&&(e.axisTimelineLeft=i.first),x.xc(i=x.gc())&&(e.timeContext=i.first),x.xc(i=x.gc())&&(e.timeContextLine=i.first),x.xc(i=x.gc())&&(e.timeContextBrush=i.first),x.xc(i=x.gc())&&(e.zoomContainer=i.first),x.xc(i=x.gc())&&(e.canvas=i.first),x.xc(i=x.gc())&&(e.tooltipRef=i.first),x.xc(i=x.gc())&&(e.tooltipRefBar=i.first))},hostBindings:function(t,e){1&t&&x.fc("keydown.shift",(function(){return e.shiftPushed()}),!1,x.Ac)("keyup.shift",(function(){return e.shiftReleased()}),!1,x.Ac)("resize",(function(t){return e.redraw(t)}),!1,x.Bc)},inputs:{_options:["options","_options"],_seriesData:["seriesData","_seriesData"],_uniqId:["uniqId","_uniqId"]},features:[x.Ab],decls:60,vars:52,consts:[[1,"d3-chart-wrapper"],[4,"ngIf"],[1,"block-relative"],["chartContainer",""],[3,"id"],[1,"inner"],["inner",""],["class","tooltip-line",4,"ngIf"],[1,"axis-bottom-title"],["class","axis-left-title",4,"ngIf"],["class","axis-right-title",4,"ngIf"],[1,"axis","axis-x-bottom"],["axisBottom",""],[1,"axis","axis-x-top"],["axisTop",""],[1,"x-grid"],["xGrid",""],[1,"axis","axis-y-left"],["axisLeft",""],[1,"axis","axis-y-right"],["axisRight",""],[1,"y-grid"],["yGrid",""],[1,"plot"],["plotContainer",""],["zoomContainer",""],[1,"bars"],["barsContainer",""],[1,"lines"],["linesContainer",""],["timecontext",""],[1,"context"],["timecontextLine",""],[1,"brush"],["timecontextBrush",""],[1,"axis"],["axisContextBottom",""],["axisContextLeft",""],["class","tooltip-container-down",3,"opacity","top","left",4,"ngIf"],["class","tooltip-container-bar",3,"opacity","top","left",4,"ngIf"],[2,"display","none"],["measureCanvas",""],["loader",""],[1,"d3-legend-wrapper"],[1,"d3-legend-container"],["class","d3-legend-item",3,"click",4,"ngFor","ngForOf"],[1,"d3-legend-item",3,"click"],[1,"d3-legend-icon"],[1,"d3-legend-text"],[1,"tooltip-line"],[1,"axis-left-title"],[1,"axis-right-title"],[1,"tooltip-container-down"],["tooltipContainer",""],[1,"tooltip-header"],[3,"innerHTML"],[1,"tooltip-container-bar"],["tooltipContainerBar",""],[3,"isInline"]],template:function(t,e){1&t&&(x.Xb(0,"div",0),x.Lc(1,gt,3,3,"ng-container",1),x.Xb(2,"div",2),x.ic(),x.Xb(3,"svg",null,3),x.Xb(5,"defs"),x.Xb(6,"clipPath",4),x.Sb(7,"rect"),x.Wb(),x.Wb(),x.Xb(8,"g",5,6),x.Lc(10,bt,3,3,"g",7),x.kc(11,"async"),x.kc(12,"async"),x.Xb(13,"g",8),x.Lc(14,ut,3,3,"text",1),x.kc(15,"async"),x.Lc(16,mt,1,8,"rect",1),x.kc(17,"async"),x.Wb(),x.Lc(18,yt,4,4,"g",9),x.kc(19,"async"),x.Lc(20,ft,4,4,"g",10),x.kc(21,"async"),x.Sb(22,"g",11,12),x.Sb(24,"g",13,14),x.Sb(26,"g",15,16),x.Sb(28,"g",17,18),x.Sb(30,"g",19,20),x.Sb(32,"g",21,22),x.Xb(34,"g",23,24),x.Sb(36,"rect",null,25),x.Sb(38,"g",26,27),x.Sb(40,"g",28,29),x.Wb(),x.Wb(),x.Wb(),x.Xb(42,"svg",null,30),x.kc(44,"async"),x.Xb(45,"g",31),x.Sb(46,"g",28,32),x.Sb(48,"g",33,34),x.Sb(50,"g",35,36),x.Sb(52,"g",35,37),x.Wb(),x.Wb(),x.Lc(54,xt,7,13,"div",38),x.Lc(55,wt,6,11,"div",39),x.Wb(),x.Wb(),x.hc(),x.Sb(56,"canvas",40,41),x.Lc(58,vt,1,1,"ng-template",null,42,x.Mc)),2&t&&(x.Db(1),x.pc("ngIf",e.drawingSeries.length>1),x.Db(2),x.Kc("width","100%")("height","285px"),x.Db(3),x.pc("id","clip"+e.uniqueId),x.Db(1),x.Eb("width",e.plotProps.width)("height",e.plotProps.height>0?e.plotProps.height-10:0),x.Db(1),x.Kc("height",e.plotProps.height-10,"px")("width",e.plotProps.width,"px"),x.Eb("transform","translate("+e.padding.left+","+(e.padding.top+10)+")"),x.Db(2),x.pc("ngIf",!!x.lc(11,38,e.series$)&&x.lc(12,40,e.series$).length),x.Db(3),x.Eb("transform","translate("+e.bottomAxisTranslate+","+(e.plotProps.height+e.padding.bottom)+")"),x.Db(1),x.pc("ngIf",x.lc(15,42,e.options$).xAxisTitle),x.Db(2),x.pc("ngIf",!x.lc(17,44,e.options$).xAxisTitle),x.Db(2),x.pc("ngIf",x.lc(19,46,e.options$).yAxisTitle),x.Db(2),x.pc("ngIf",x.lc(21,48,e.options$).secondaryYAxisTitle),x.Db(2),x.Eb("transform","translate(0,"+(e.plotProps.height-10)+")"),x.Db(4),x.Eb("transform","translate(0,"+(e.plotProps.height-10)+")"),x.Db(2),x.Eb("transform","translate(0, -10)"),x.Db(2),x.Eb("transform","translate("+e.plotProps.width+", 0)"),x.Db(4),x.Eb("clip-path","url(#clip"+e.uniqueId+")"),x.Db(2),x.Kc("width","100%"),x.Eb("fill","transparent"),x.Db(4),x.Eb("transform",e.existBarSeries?"translate("+e.xPrimaryScale.bandwidth()/2+",0)":"translate("+e.paddingXTypeLine+",-10)"),x.Db(2),x.Kc("width","100%")("height","90px")("display",x.lc(44,50,e.options$).showTimeline?"block":"none"),x.Db(3),x.Eb("transform","translate("+e.padding.left+",0)"),x.Db(5),x.Eb("transform","translate(0,40)"),x.Db(4),x.pc("ngIf",e.drawingSeries.length&&e.existLineSeries),x.Db(1),x.pc("ngIf",e.drawingSeries.length&&e.existBarSeries))},directives:[n.m,n.l,z.a],pipes:[n.b,N.a],styles:[".d3-legend-wrapper[_ngcontent-%COMP%]{margin-top:-10px!important;right:10px!important}.block-relative[_ngcontent-%COMP%]{position:relative}.title-none-xprimary[_ngcontent-%COMP%]{fill:#9a9a9a}"]}),t})();var Ct=i("h4wM"),Pt=i("iaTl"),St=i("Y+mK"),Mt=i("FH+O"),Ot=i("cWD+"),Dt=i("d3UM"),_t=i("3Pt+"),Tt=i("FKr1"),At=i("nJc8"),Lt=i("iadO");let It=(()=>{class t{transform(t){return t instanceof y.i?"indicator":t instanceof y.f?"commonPlot":t instanceof y.h?"horizontalBars":t instanceof y.g?"funnel":t instanceof y.l?"synchronized":t instanceof y.k?"scatter":void 0}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=x.Qb({name:"VisualizationCheckType",type:t,pure:!0}),t})(),$t=(()=>{class t{transform(t,e,...i){let n;switch(e){case"from-request":t.from&&t.to&&(n={begin:new Date(t.from),end:new Date(t.to)});break;case"to-string":t.begin&&t.end&&(n=`${this.formatDate(t.begin)} &ndash; ${this.formatDate(t.end)}`),t.from&&t.to&&(n=`${t.from.split("T")[0]} &ndash; ${t.to.split("T")[0]}`)}return n}formatDate(t){const e=new Date(t.getTime()-60*t.getTimezoneOffset()*1e3);return`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getUTCMonth()]} ${e.getUTCDate()}, ${e.getFullYear()}`}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=x.Qb({name:"dateRange",type:t,pure:!0}),t})();function jt(t,e){if(1&t&&(x.Sb(0,"m-kpi-widget",10),x.kc(1,"async"),x.kc(2,"async"),x.kc(3,"async")),2&t){const t=x.jc(2);x.pc("value",x.lc(1,4,t.data$))("unit",t.visualization.label)("previous",x.lc(2,6,t.previousData$))("params",x.lc(3,8,t.params$))}}function Vt(t,e){if(1&t&&(x.Vb(0),x.Xb(1,"div"),x.Tb(2,7),x.Xb(3,"div",8),x.Lc(4,jt,4,10,"m-kpi-widget",9),x.kc(5,"async"),x.Wb(),x.Wb(),x.Ub()),2&t){const t=x.jc(),e=x.yc(7);x.Db(1),x.Fb(t.userOS+" widget-kpi-container"),x.Db(1),x.pc("ngTemplateOutlet",e),x.Db(2),x.pc("ngIf",x.lc(5,4,t.data$))}}function Wt(t,e){if(1&t&&(x.Vb(0),x.Tb(1,7),x.Xb(2,"div",12),x.Nc(3),x.Wb(),x.Xb(4,"div",8),x.Tb(5,7),x.Wb(),x.Ub()),2&t){const t=x.jc(2),e=x.yc(7),i=x.yc(5);x.Db(1),x.pc("ngTemplateOutlet",e),x.Db(2),x.Oc(t.visualization.subtitle),x.Db(2),x.pc("ngTemplateOutlet",i)}}function Et(t,e){if(1&t&&(x.Vb(0),x.Xb(1,"div"),x.Lc(2,Wt,6,3,"ng-container",11),x.kc(3,"async"),x.Wb(),x.Ub()),2&t){const t=x.jc(),e=x.yc(11);x.Db(1),x.Fb(t.userOS+" widget-chart-container"),x.Db(1),x.pc("ngIf",x.lc(3,4,t.data$))("ngIfElse",e)}}function Bt(t,e){if(1&t&&(x.Vb(0),x.Sb(1,"m-d3-dashboard-plot",13),x.kc(2,"async"),x.Ub()),2&t){const t=x.jc(2);x.Db(1),x.Kc("width","100%"),x.pc("options",t.visualization)("seriesData",x.lc(2,5,t.data$).result.result)("uniqId",t.uniqId)}}function Xt(t,e){if(1&t&&(x.Vb(0),x.Sb(1,"m-d3-scatterplot",14),x.kc(2,"async"),x.Ub()),2&t){const t=x.jc(2);x.Db(1),x.pc("maxHeight",250)("options",t.visualization)("seriesData",x.lc(2,3,t.data$).result.result)}}function Rt(t,e){if(1&t&&(x.Vb(0),x.Sb(1,"m-d3-funnel",16),x.kc(2,"async"),x.Ub()),2&t){const t=x.jc(3);x.Db(1),x.pc("options",t.visualization)("seriesData",x.lc(2,2,t.data$).result.result)}}function qt(t,e){if(1&t&&(x.Vb(0),x.Sb(1,"m-d3-segmented-funnel",16),x.kc(2,"async"),x.Ub()),2&t){const t=x.jc(3);x.Db(1),x.pc("options",t.visualization)("seriesData",x.lc(2,2,t.data$).result.result)}}function zt(t,e){if(1&t&&(x.Vb(0),x.Lc(1,Rt,3,4,"ng-container",15),x.kc(2,"async"),x.Lc(3,qt,3,4,"ng-container",15),x.kc(4,"async"),x.Ub()),2&t){const t=x.jc(2);x.Db(1),x.pc("ngIf",1===x.lc(2,2,t.data$).result.result.length),x.Db(2),x.pc("ngIf",x.lc(4,4,t.data$).result.result.length>1)}}function Nt(t,e){if(1&t&&(x.Vb(0),x.Sb(1,"m-d3-horizontal-bars",17),x.kc(2,"async"),x.Ub()),2&t){const t=x.jc(2);x.Db(1),x.pc("seriesData",x.lc(2,3,t.data$).result.result)("options",t.visualization)("countRows",10)}}function Ut(t,e){if(1&t&&(x.Vb(0),x.Sb(1,"m-d3-synchronized",18),x.kc(2,"async"),x.Ub()),2&t){const t=x.jc(2);x.Db(1),x.pc("seriesData",x.lc(2,2,t.data$).result.result)("options",t.visualization)}}function Kt(t,e){if(1&t&&(x.Vb(0,0),x.kc(1,"VisualizationCheckType"),x.Lc(2,Bt,3,7,"ng-container",1),x.Lc(3,Xt,3,5,"ng-container",1),x.Lc(4,zt,5,6,"ng-container",1),x.Lc(5,Nt,3,5,"ng-container",1),x.Lc(6,Ut,3,4,"ng-container",1),x.Ub()),2&t){const t=x.jc();x.pc("ngSwitch",x.lc(1,6,t.visualization)),x.Db(2),x.pc("ngSwitchCase","commonPlot"),x.Db(1),x.pc("ngSwitchCase","scatter"),x.Db(1),x.pc("ngSwitchCase","funnel"),x.Db(1),x.pc("ngSwitchCase","horizontalBars"),x.Db(1),x.pc("ngSwitchCase","synchronized")}}function Yt(t,e){if(1&t&&x.Sb(0,"i",24),2&t){const t=x.jc(2);x.qc("matTooltip",t.visualization.description)}}function Ft(t,e){if(1&t&&(x.Xb(0,"div",19),x.Xb(1,"div",20),x.Xb(2,"div",21),x.Nc(3),x.Lc(4,Yt,1,1,"i",22),x.Wb(),x.Wb(),x.Xb(5,"div",23),x.Tb(6,7),x.Wb(),x.Wb()),2&t){const t=x.jc(),e=x.yc(9);x.Db(3),x.Pc(" ",t.visualization.name," "),x.Db(1),x.pc("ngIf",t.visualization.description),x.Db(2),x.pc("ngTemplateOutlet",e)}}function Ht(t,e){if(1&t&&(x.Xb(0,"mat-option",29),x.Nc(1),x.Wb()),2&t){const t=e.$implicit;x.pc("value",t.value?t.value:t),x.Db(1),x.Pc(" ",t.value?t.value:t," ")}}function Jt(t,e){if(1&t){const t=x.Yb();x.Vb(0),x.Xb(1,"div",26),x.Xb(2,"mat-select",27),x.fc("ngModelChange",(function(e){x.Cc(t);const i=x.jc().$implicit,n=x.jc(2);return n.selectedParamValueMap.set(n.uniqId+"_"+i.key,e),n.onReload()})),x.Lc(3,Ht,2,2,"mat-option",28),x.Wb(),x.Wb(),x.Ub()}if(2&t){const t=x.jc().$implicit,e=x.jc(2);x.Db(2),x.pc("ngModel",e.selectedParamValueMap.has(e.uniqId+"_"+t.key)?e.selectedParamValueMap.get(e.uniqId+"_"+t.key):null),x.Db(1),x.pc("ngForOf",e.paramDataMap.get(t.key))}}function Gt(t,e){if(1&t){const t=x.Yb();x.Vb(0),x.Xb(1,"div",30),x.fc("click",(function(){return x.Cc(t),x.yc(8).open()})),x.Sb(2,"span",31),x.kc(3,"safe"),x.kc(4,"dateRange"),x.Xb(5,"input",32),x.fc("dateChange",(function(e){x.Cc(t);const i=x.jc().$implicit;return x.jc(2).onDateChanged(i,e)})),x.kc(6,"dateRange"),x.Wb(),x.Sb(7,"sat-datepicker",33,34),x.Wb(),x.Ub()}if(2&t){const t=x.yc(8),e=x.jc().$implicit,i=x.jc(2);x.Db(2),x.pc("innerHTML",x.mc(3,4,x.mc(4,7,i.selectedParamValueMap.get(i.uniqId+"_"+e.key),"to-string"),"html"),x.Dc),x.Db(3),x.pc("satDatepicker",t)("value",x.mc(6,10,i.selectedParamValueMap.get(i.uniqId+"_"+e.key),"from-request")),x.Db(2),x.pc("rangeMode",!0)}}function Qt(t,e){if(1&t){const t=x.Yb();x.Vb(0),x.Xb(1,"div",26),x.Xb(2,"input",35),x.fc("ngModelChange",(function(e){x.Cc(t);const i=x.jc().$implicit,n=x.jc(2);return n.selectedParamValueMap.set(n.uniqId+"_"+i.key,e),n.onReload()})),x.Wb(),x.Xb(3,"button",36),x.fc("click",(function(){return x.Cc(t),x.yc(7).open()})),x.Nc(4),x.kc(5,"date"),x.Wb(),x.Sb(6,"mat-datepicker",null,34),x.Wb(),x.Ub()}if(2&t){const t=x.yc(7),e=x.jc().$implicit,i=x.jc(2);x.Db(2),x.pc("matDatepicker",t)("ngModel",i.selectedParamValueMap.has(i.uniqId+"_"+e.key)?i.selectedParamValueMap.get(i.uniqId+"_"+e.key):null),x.Db(2),x.Pc(" ",x.mc(5,3,i.selectedParamValueMap.get(i.uniqId+"_"+e.key),"mediumDate")," ")}}function Zt(t,e){if(1&t){const t=x.Yb();x.Vb(0),x.Xb(1,"div",26),x.Xb(2,"input",35),x.fc("ngModelChange",(function(e){x.Cc(t);const i=x.jc().$implicit,n=x.jc(2);return n.selectedParamValueMap.set(n.uniqId+"_"+i.key,e),n.onReload()})),x.Wb(),x.Xb(3,"button",36),x.fc("click",(function(){return x.Cc(t),x.yc(7).open()})),x.Nc(4),x.kc(5,"date"),x.Wb(),x.Xb(6,"mat-datepicker",37,38),x.fc("yearSelected",(function(e){x.Cc(t);const i=x.jc().$implicit;return x.jc(2).yearHandler(i,e)}))("monthSelected",(function(e){x.Cc(t);const i=x.yc(7),n=x.jc().$implicit;return x.jc(2).monthHandler(n,e,i)})),x.Wb(),x.Wb(),x.Ub()}if(2&t){const t=x.yc(7),e=x.jc().$implicit,i=x.jc(2);x.Db(2),x.pc("matDatepicker",t)("ngModel",i.selectedParamValueMap.has(i.uniqId+"_"+e.key)?i.selectedParamValueMap.get(i.uniqId+"_"+e.key):null),x.Db(2),x.Pc(" ",x.mc(5,3,i.selectedParamValueMap.get(i.uniqId+"_"+e.key),"MMM yyyy")," ")}}function te(t,e){if(1&t){const t=x.Yb();x.Vb(0),x.Xb(1,"div",39),x.fc("click",(function(){return x.Cc(t),x.yc(3).open()})),x.Xb(2,"mat-select",40,41),x.fc("ngModelChange",(function(e){x.Cc(t);const i=x.jc().$implicit,n=x.jc(2);return n.selectedParamValueMap.set(n.uniqId+"_"+i.key,e),n.onReload()})),x.Xb(4,"mat-option",29),x.Nc(5,"Day"),x.Wb(),x.Xb(6,"mat-option",29),x.Nc(7,"Week"),x.Wb(),x.Xb(8,"mat-option",29),x.Nc(9,"Month"),x.Wb(),x.Xb(10,"mat-option",29),x.Nc(11,"Quarter"),x.Wb(),x.Wb(),x.Wb(),x.Ub()}if(2&t){const t=x.jc().$implicit,e=x.jc(2);x.Db(2),x.pc("ngModel",e.selectedParamValueMap.has(e.uniqId+"_"+t.key)?e.selectedParamValueMap.get(e.uniqId+"_"+t.key):null),x.Db(2),x.pc("value",e.partitionEnum.Day),x.Db(2),x.pc("value",e.partitionEnum.Week),x.Db(2),x.pc("value",e.partitionEnum.Month),x.Db(2),x.pc("value",e.partitionEnum.Quarter)}}function ee(t,e){if(1&t&&(x.Vb(0),x.Vb(1,0),x.Lc(2,Jt,4,2,"ng-container",1),x.Lc(3,Gt,9,13,"ng-container",1),x.Lc(4,Qt,8,6,"ng-container",1),x.Lc(5,Zt,8,6,"ng-container",1),x.Lc(6,te,12,5,"ng-container",1),x.Ub(),x.Ub()),2&t){const t=e.$implicit,i=x.jc(2);x.Db(1),x.pc("ngSwitch",t.type),x.Db(1),x.pc("ngSwitchCase",i.paramTypeEnum.Select),x.Db(1),x.pc("ngSwitchCase",i.paramTypeEnum.DateRange),x.Db(1),x.pc("ngSwitchCase",i.paramTypeEnum.Date),x.Db(1),x.pc("ngSwitchCase",i.paramTypeEnum.Month),x.Db(1),x.pc("ngSwitchCase",i.paramTypeEnum.TimePartition)}}function ie(t,e){if(1&t&&(x.Lc(0,ee,7,6,"ng-container",25),x.kc(1,"async")),2&t){const t=x.jc();x.pc("ngForOf",x.lc(1,1,t.params$))}}function ne(t,e){1&t&&(x.Xb(0,"div",42),x.Xb(1,"div",43),x.Sb(2,"div",44),x.Sb(3,"div",45),x.Sb(4,"div",46),x.Sb(5,"div",47),x.Wb(),x.Wb())}let ae=(()=>{class t{constructor(t,e,i){this.windowRefService=t,this.queryService=e,this.datePipe=i,this.destroy$=new p.a,this.data$=new g.a(null),this.previousData$=new g.a(null),this.widgetData$=new g.a(null),this.params$=new g.a(null),this.project$=new g.a(null),this.database$=new g.a(null),this.uniqId$=new g.a(null),this.paramDataMap=new Map(null),this.selectedParamValueMap=new Map(null),this.partitionEnum=f.l,this.paramTypeEnum=f.h,this.userOS=this.windowRefService.detectOperatingSystem()+"-os"}set _widgetData(t){this.widgetData$.next(t),this.visualization=t.query.output}set _params(t){this.params$.next(t)}set _project(t){this.project$.next(t)}set _database(t){this.database$.next(t)}set _uniqId(t){this.uniqId=t,this.uniqId$.next(t)}ngOnInit(){const t=new Array;Object(w.a)([this.widgetData$,this.params$,this.project$,this.database$,this.uniqId$]).pipe(Object(b.a)(this.destroy$),Object(k.a)(([t,e,i,n])=>!!(t&&e&&i&&n)),Object(C.a)(([e,i,n,a,s])=>{this.aggregateData={widgetData:e,params:i,project:n,database:a,uniqId:s};const o=i.filter(t=>!!t.inputSql).map(e=>(t.push(e.key),this.queryService.retrieveParameterValues({},n,a,e.key)));return o.length>0?Object(w.a)([...o]).pipe(Object(b.a)(this.destroy$)):Object(v.a)([])}),Object(C.a)(e=>{const{widgetData:i,params:n,project:a,database:s}=this.aggregateData;let o,r,c={};return this.setupParameterOptions(n,e,t),c=this.setupPreselParamVals(n),o=this.queryService.sendWidgetRequest(c,a,s,i.key),r=this.visualization.kind===y.j.Indicator?this.getPreviousData(c,a,s,i.key):Object(v.a)(null),Object(w.a)([o,r]).pipe(Object(b.a)(this.destroy$))})).subscribe(([t,e])=>{this.data$.next(t),e&&this.previousData$.next(e)})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}onDateChanged(t,e){const i={begin:new Date(e.value.begin),end:new Date(e.value.end)};this.selectedParamValueMap.set(this.uniqId+"_"+t.key,i),this.widgetData$.next(this.widgetData$.getValue())}yearHandler(t,e){this.selectedParamValueMap.set(this.uniqId+"_"+t.key,e.setFullYear(e.getFullYear()))}monthHandler(t,e,i){this.selectedParamValueMap.set(this.uniqId+"_"+t.key,new Date(e.setMonth(e.getMonth()))),i.close(),this.widgetData$.next(this.widgetData$.getValue())}onReload(){this.widgetData$.next(this.widgetData$.getValue())}toRequestJson(t,e){switch(t.type){case f.h.Boolean:case f.h.Numeric:case f.h.Select:return e;case f.h.Date:return S.a.DateTimeSerializer.toJson(e);case f.h.Month:return+this.datePipe.transform(e,"yyyyMM");case f.h.DateRange:return{from:S.a.DateTimeSerializer.toJson(e.begin),to:S.a.DateTimeSerializer.toJson(e.end)};case f.h.TimePartition:return f.l.toJson(e);default:return`${e}`}}getPreviousData(t,e,i,n){let a=Object.assign({},t);if(a.hasOwnProperty("date")){const t=new Date(a.date),e=new Date(t);e.setTime(t.getTime()-864e5),a.date=S.a.DateTimeSerializer.toJson(e)}if(a.hasOwnProperty("month")){const t=new Date(Math.floor(a.month)+"-"+a.month%100),e=new Date(t),i=e.getFullYear(),n=0===e.getMonth();e.setDate(1),n?(e.setMonth(11),e.setFullYear(i-1)):e.setMonth(e.getMonth()-1),a.month=+this.datePipe.transform(e,"yyyyMM")}if(a.hasOwnProperty("time")){const t=864e5,e={begin:new Date(a.time.from),end:new Date(a.time.to)},i=Math.abs((e.begin.getTime()-e.end.getTime())/t),n=new Date(e.begin.getTime()-t),s=new Date(n.getTime()-1e3*i*3600*24);a={time:{from:S.a.DateTimeSerializer.toJson(s),to:S.a.DateTimeSerializer.toJson(n)}}}return this.queryService.sendWidgetRequest(a,e,i,n)}setupParameterOptions(t,e,i){i.forEach((t,i)=>{this.paramDataMap.has(t)||this.paramDataMap.set(t,e[i].items.map(t=>t.value))}),t.filter(t=>!this.paramDataMap.has(t.key)).forEach(t=>{this.paramDataMap.set(t.key,this.getPredefParamVals(t))})}setupPreselParamVals(t){const e={};return t.forEach(t=>{this.selectedParamValueMap.has(this.uniqId+"_"+t.key)||this.selectedParamValueMap.set(this.uniqId+"_"+t.key,this.paramDataMap.get(t.key)[0]),e[t.key]=this.toRequestJson(t,this.selectedParamValueMap.get(this.uniqId+"_"+t.key))}),e}getPredefParamVals(t){switch(t.type){case f.h.Boolean:return[!0];case f.h.Numeric:return[0];case f.h.Date:case f.h.Month:return[new Date];case f.h.DateRange:const e=new Date,i=new Date(e);return i.setMonth(i.getMonth()-1),[{begin:i,end:e}];case f.h.TimePartition:return[f.l.Day,f.l.Week,f.l.Month,f.l.Quarter];case f.h.Select:if(t.inputSql)return[""];if(t.values instanceof Array)return t.values.length>0?t.values.map(t=>t.value):[null];switch(t.valueType){case f.f.Bool:return[!0];case f.f.Number:return[0];case f.f.String:return[""];default:return[null]}default:return[null]}}}return t.\u0275fac=function(e){return new(e||t)(x.Rb(P.a),x.Rb(m.a),x.Rb(n.e))},t.\u0275cmp=x.Lb({type:t,selectors:[["m-widget-box"]],inputs:{_widgetData:["widgetData","_widgetData"],_params:["params","_params"],_project:["project","_project"],_database:["database","_database"],_uniqId:["uniqId","_uniqId"]},decls:12,vars:4,consts:[[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["chart",""],["header",""],["metadataBtns",""],["chartLoading",""],[3,"ngTemplateOutlet"],[1,"widget-content"],[3,"value","unit","previous","params",4,"ngIf"],[3,"value","unit","previous","params"],[4,"ngIf","ngIfElse"],[1,"widget-subtitle"],[3,"options","seriesData","uniqId"],[3,"maxHeight","options","seriesData"],[4,"ngIf"],[3,"options","seriesData"],[3,"seriesData","options","countRows"],[3,"seriesData","options"],[1,"widget-header"],[1,"widget-title-container"],[1,"widget-title"],["matTooltipClass","basic-font","class","widget-tooltip la la-info-circle hint-icon dimmed",3,"matTooltip",4,"ngIf"],[1,"metadata-btns"],["matTooltipClass","basic-font",1,"widget-tooltip","la","la-info-circle","hint-icon","dimmed",3,"matTooltip"],[4,"ngFor","ngForOf"],[1,"metadata-container"],["disableRipple","",1,"select-parameter",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"metadata-container","metadata-button","picker",3,"click"],[3,"innerHTML"],[2,"visibility","hidden","width","0","height","0",3,"satDatepicker","value","dateChange"],[3,"rangeMode"],["picker",""],[1,"m-datepicker-input",3,"matDatepicker","ngModel","ngModelChange"],[1,"metadata-button","picker",3,"click"],["startView","multi-year",3,"yearSelected","monthSelected"],["multiYearPicker",""],[1,"metadata-container","time-span-picker","picker",3,"click"],[3,"ngModel","ngModelChange"],["timeSpanPicker",""],[1,"chart-loading-wrapper"],[1,"chart-loading-container"],[1,"loading-box","loading-box-1"],[1,"loading-box","loading-box-2"],[1,"loading-box","loading-box-3"],[1,"loading-box","loading-box-4"]],template:function(t,e){1&t&&(x.Vb(0,0),x.kc(1,"VisualizationCheckType"),x.Lc(2,Vt,6,6,"ng-container",1),x.Lc(3,Et,4,6,"ng-container",2),x.Ub(),x.Lc(4,Kt,7,8,"ng-template",null,3,x.Mc),x.Lc(6,Ft,7,3,"ng-template",null,4,x.Mc),x.Lc(8,ie,2,3,"ng-template",null,5,x.Mc),x.Lc(10,ne,6,0,"ng-template",null,6,x.Mc)),2&t&&(x.pc("ngSwitch",x.lc(1,2,e.visualization)),x.Db(2),x.pc("ngSwitchCase","indicator"))},directives:[n.o,n.p,n.q,n.r,n.m,W,kt,Ct.a,Pt.a,St.a,Mt.a,Ot.a,o.a,n.l,Dt.a,_t.j,_t.m,Tt.o,At.b,At.a,Lt.b,_t.b,Lt.a],pipes:[It,n.b,N.a,$t,n.e],styles:[".widget-kpi-container[_ngcontent-%COMP%]{height:100px}.widget-chart-container[_ngcontent-%COMP%], .widget-kpi-container[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column;padding:21px;background-color:#fff;border-radius:2px;box-shadow:0 0 10px rgba(0,0,0,.1);-webkit-transition:all .3s cubic-bezier(.25,.8,.25,1);transition:all .3s cubic-bezier(.25,.8,.25,1);margin-bottom:10px}.widget-chart-container[_ngcontent-%COMP%]{height:400px}.widget-header[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row;-webkit-box-align:baseline;align-items:baseline;-webkit-box-pack:justify;justify-content:space-between;margin-bottom:4px}.widget-title-container[_ngcontent-%COMP%]{-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}.widget-title[_ngcontent-%COMP%]{font-size:16px;font-weight:700}.widget-subtitle[_ngcontent-%COMP%]{margin-top:4px;padding-bottom:20px}.widget-tooltip[_ngcontent-%COMP%]{font-size:1.3rem;font-weight:600;color:#979797;margin:-5px 0 0 -3px}.widget-content[_ngcontent-%COMP%]{display:block;width:100%;height:100%}.metadata-btns[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row;-webkit-box-pack:justify;justify-content:space-between}.metadata-button[_ngcontent-%COMP%], .select-parameter[_ngcontent-%COMP%], .time-span-picker[_ngcontent-%COMP%]{min-width:-webkit-max-content;min-width:-moz-max-content;min-width:max-content;font-size:12px;border:1px solid #c4c4c4;border-radius:17px;padding:3px 10px;background-color:#fff;margin-left:auto}.metadata-button.picker[_ngcontent-%COMP%]:hover, .picker.select-parameter[_ngcontent-%COMP%]:hover, .picker.time-span-picker[_ngcontent-%COMP%]:hover{cursor:pointer;background-color:#f4f5f8}.metadata-container[_ngcontent-%COMP%]:not(:last-child){margin-right:9px}.time-span-picker[_ngcontent-%COMP%]{width:100px}.select-parameter[_ngcontent-%COMP%]{margin-left:9px;width:200px}.m-datepicker-input[_ngcontent-%COMP%]{width:0;height:0;padding:0;margin:0;border:none;visibility:hidden}.chart-loading-wrapper[_ngcontent-%COMP%]{height:100%;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}.chart-loading-container[_ngcontent-%COMP%], .chart-loading-wrapper[_ngcontent-%COMP%]{width:100%;display:-webkit-box;display:flex;-webkit-box-pack:center;justify-content:center}.chart-loading-container[_ngcontent-%COMP%]{height:30%;-webkit-box-align:end;align-items:flex-end}.chart-loading-container[_ngcontent-%COMP%]   .loading-box[_ngcontent-%COMP%]{margin:0 5px;background-color:#d7d7d7;height:10%;width:5%;opacity:.4}.chart-loading-container[_ngcontent-%COMP%]   .loading-box-1[_ngcontent-%COMP%]{-webkit-animation:animChartLoader 4.3s ease-in-out .26s infinite;animation:animChartLoader 4.3s ease-in-out .26s infinite}.chart-loading-container[_ngcontent-%COMP%]   .loading-box-2[_ngcontent-%COMP%]{-webkit-animation:animChartLoader 4.3s ease-in-out .52s infinite;animation:animChartLoader 4.3s ease-in-out .52s infinite}.chart-loading-container[_ngcontent-%COMP%]   .loading-box-3[_ngcontent-%COMP%]{-webkit-animation:animChartLoader 4.3s ease-in-out .78s infinite;animation:animChartLoader 4.3s ease-in-out .78s infinite}.chart-loading-container[_ngcontent-%COMP%]   .loading-box-4[_ngcontent-%COMP%]{-webkit-animation:animChartLoader 4.3s ease-in-out 1.04s infinite;animation:animChartLoader 4.3s ease-in-out 1.04s infinite}@-webkit-keyframes animChartLoader{0%{height:10%}15%{height:100%}35%{height:10%}90%{height:10%}to{height:10%}}@keyframes animChartLoader{0%{height:10%}15%{height:100%}35%{height:10%}90%{height:10%}to{height:10%}}  .mat-select{font-family:-apple-system,Lucida Grande,Ubuntu sans-serif,Oxygen-Sans,Cantarell,Helvetica Neue,sans-serif!important}"],changeDetection:0}),t})();function se(t,e){if(1&t&&(x.Vb(0),x.Xb(1,"div"),x.Sb(2,"m-widget-box",5),x.Wb(),x.Ub()),2&t){const t=e.$implicit,i=e.index,n=x.jc(2);x.Db(1),x.Fb("widget col-lg-"+t.widthCols+" col-xl-"+(t.widthCols-0)),x.Db(1),x.pc("widgetData",t)("params",n.paramsMap.get(t.key))("project",n.project.id)("database",n.database)("uniqId",i)}}function oe(t,e){if(1&t&&(x.Vb(0),x.Xb(1,"div",3),x.Lc(2,se,3,7,"ng-container",4),x.kc(3,"async"),x.Wb(),x.Ub()),2&t){const t=x.jc();x.Db(2),x.pc("ngForOf",x.lc(3,1,t.widgets$))}}function re(t,e){1&t&&(x.Xb(0,"div",6),x.Xb(1,"div",7),x.Sb(2,"div",8),x.Sb(3,"div",9),x.Sb(4,"div",10),x.Sb(5,"div",11),x.Wb(),x.Wb())}let ce=(()=>{class t{constructor(t,e){this.route=t,this.queryService=e,this.destroy$=new p.a,this.dashboardData$=new g.a(null),this.widgets$=new g.a(null),this.loading$=new g.a(null),this.paramsMap=new Map,this.route.data.pipe(Object(b.a)(this.destroy$),Object(u.a)(t=>this.loading$.next(!0))).subscribe(t=>{this.initialize(t.activeProject.project,t.activeProject.database)}),this.dashboardData$.pipe(Object(b.a)(this.destroy$)).subscribe(t=>{t&&(t.widgets.forEach(e=>{const i=e.params.map(e=>t.params.find(t=>t.id===e));this.paramsMap.set(e.key,i)}),this.widgets$.next(t.widgets))}),this.option={kind:y.j.BoxPlot,name:"Box plot",subtitle:"",description:"",showXAxis:!0,showYAxis:!0,showXGridLine:!0,showYGridLine:!0,xAxisType:y.b.Text,yAxisType:y.b.Numeric,xAxisTitle:"1",yAxisTitle:"2",showLegend:!0},this.data={kind:f.j.BoxPlot,key:"value",data:[{label:"intro",value:[105,200,94,16,83,144,95,368,134,88,86,82,110,94,102,107,157,167,200,202,146,66,230,396,109]},{label:"ty_spy",value:[1025,591,377,434,374,444,490,505,571,485,475,368,591,368,374,282,474,479,291,411,320,302,198,2,446]},{label:"sh_smr",value:[10,229,147,210,157,240,224,275,313,140,209,195,222,215,282,354,310,206,202,270,281,318,151,126,900]}]}}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}initialize(t,e){this.project=t,this.database=e,this.queryService.getDashboardData(this.project.id).pipe(Object(b.a)(this.destroy$)).subscribe(t=>{t&&this.dashboardData$.next(t)})}}return t.\u0275fac=function(e){return new(e||t)(x.Rb(a.a),x.Rb(m.a))},t.\u0275cmp=x.Lb({type:t,selectors:[["m-dashboard-overview"]],decls:5,vars:4,consts:[[1,"dashboard","neat-font"],[4,"ngIf","ngIfElse"],["loading",""],[1,"row"],[4,"ngFor","ngForOf"],[3,"widgetData","params","project","database","uniqId"],[1,"chart-loading-wrapper"],[1,"chart-loading-container"],[1,"loading-box","loading-box-1"],[1,"loading-box","loading-box-2"],[1,"loading-box","loading-box-3"],[1,"loading-box","loading-box-4"]],template:function(t,e){if(1&t&&(x.Xb(0,"div",0),x.Lc(1,oe,4,3,"ng-container",1),x.kc(2,"async"),x.Wb(),x.Lc(3,re,6,0,"ng-template",null,2,x.Mc)),2&t){const t=x.yc(4);x.Db(1),x.pc("ngIf",x.lc(2,2,e.widgets$))("ngIfElse",t)}},directives:[n.m,n.l,ae],pipes:[n.b],styles:["*[_ngcontent-%COMP%]{line-height:normal}.dashboard[_ngcontent-%COMP%]{height:auto}.row[_ngcontent-%COMP%]{margin:0}m-kpi-widget[_ngcontent-%COMP%]{width:100%}.col-1[_ngcontent-%COMP%], .col-2[_ngcontent-%COMP%], .col-3[_ngcontent-%COMP%], .col-4[_ngcontent-%COMP%], .col-5[_ngcontent-%COMP%], .col-6[_ngcontent-%COMP%], .col-7[_ngcontent-%COMP%], .col-8[_ngcontent-%COMP%], .col-9[_ngcontent-%COMP%], .col-10[_ngcontent-%COMP%], .col-11[_ngcontent-%COMP%], .col-12[_ngcontent-%COMP%], .col-lg-1[_ngcontent-%COMP%], .col-lg-2[_ngcontent-%COMP%], .col-lg-3[_ngcontent-%COMP%], .col-lg-4[_ngcontent-%COMP%], .col-lg-5[_ngcontent-%COMP%], .col-lg-6[_ngcontent-%COMP%], .col-lg-7[_ngcontent-%COMP%], .col-lg-8[_ngcontent-%COMP%], .col-lg-9[_ngcontent-%COMP%], .col-lg-10[_ngcontent-%COMP%], .col-lg-11[_ngcontent-%COMP%], .col-lg-12[_ngcontent-%COMP%], .col-md-1[_ngcontent-%COMP%], .col-md-2[_ngcontent-%COMP%], .col-md-3[_ngcontent-%COMP%], .col-md-4[_ngcontent-%COMP%], .col-md-5[_ngcontent-%COMP%], .col-md-6[_ngcontent-%COMP%], .col-md-7[_ngcontent-%COMP%], .col-md-8[_ngcontent-%COMP%], .col-md-9[_ngcontent-%COMP%], .col-md-10[_ngcontent-%COMP%], .col-md-11[_ngcontent-%COMP%], .col-md-12[_ngcontent-%COMP%], .col-sm-1[_ngcontent-%COMP%], .col-sm-2[_ngcontent-%COMP%], .col-sm-3[_ngcontent-%COMP%], .col-sm-4[_ngcontent-%COMP%], .col-sm-5[_ngcontent-%COMP%], .col-sm-6[_ngcontent-%COMP%], .col-sm-7[_ngcontent-%COMP%], .col-sm-8[_ngcontent-%COMP%], .col-sm-9[_ngcontent-%COMP%], .col-sm-10[_ngcontent-%COMP%], .col-sm-11[_ngcontent-%COMP%], .col-sm-12[_ngcontent-%COMP%]{padding:0 9px 0 0}.chart-loading-wrapper[_ngcontent-%COMP%]{height:100%;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}.chart-loading-container[_ngcontent-%COMP%], .chart-loading-wrapper[_ngcontent-%COMP%]{width:100%;display:-webkit-box;display:flex;-webkit-box-pack:center;justify-content:center}.chart-loading-container[_ngcontent-%COMP%]{height:30%;-webkit-box-align:end;align-items:flex-end}.chart-loading-container[_ngcontent-%COMP%]   .loading-box[_ngcontent-%COMP%]{margin:0 5px;background-color:#d7d7d7;height:10%;width:5%;opacity:.4}.chart-loading-container[_ngcontent-%COMP%]   .loading-box-1[_ngcontent-%COMP%]{-webkit-animation:animChartLoader 4.3s ease-in-out .26s infinite;animation:animChartLoader 4.3s ease-in-out .26s infinite}.chart-loading-container[_ngcontent-%COMP%]   .loading-box-2[_ngcontent-%COMP%]{-webkit-animation:animChartLoader 4.3s ease-in-out .52s infinite;animation:animChartLoader 4.3s ease-in-out .52s infinite}.chart-loading-container[_ngcontent-%COMP%]   .loading-box-3[_ngcontent-%COMP%]{-webkit-animation:animChartLoader 4.3s ease-in-out .78s infinite;animation:animChartLoader 4.3s ease-in-out .78s infinite}.chart-loading-container[_ngcontent-%COMP%]   .loading-box-4[_ngcontent-%COMP%]{-webkit-animation:animChartLoader 4.3s ease-in-out 1.04s infinite;animation:animChartLoader 4.3s ease-in-out 1.04s infinite}@-webkit-keyframes animChartLoader{0%{height:10%}15%{height:100%}35%{height:10%}90%{height:10%}to{height:10%}}@keyframes animChartLoader{0%{height:10%}15%{height:100%}35%{height:10%}90%{height:10%}to{height:10%}}"],changeDetection:0}),t})();var le=i("n9uO");i.d(e,"DashboardModule",(function(){return he}));let he=(()=>{class t{}return t.\u0275mod=x.Pb({type:t}),t.\u0275inj=x.Ob({factory:function(e){return new(e||t)},providers:[],imports:[[n.c,s.b,o.b,r.c,l.a,h.a,d.a,a.i.forChild([{path:"**",component:ce,resolve:{activeProject:c.a}}]),le.a]]}),t})()}}]);